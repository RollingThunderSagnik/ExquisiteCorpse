{"ast":null,"code":"import _classCallCheck from\"/home/sagnikg/AAO Website/Exquisite Corpse/corpse/node_modules/@babel/runtime/helpers/esm/classCallCheck.js\";import _createClass from\"/home/sagnikg/AAO Website/Exquisite Corpse/corpse/node_modules/@babel/runtime/helpers/esm/createClass.js\";import _assertThisInitialized from\"/home/sagnikg/AAO Website/Exquisite Corpse/corpse/node_modules/@babel/runtime/helpers/esm/assertThisInitialized.js\";import _inherits from\"/home/sagnikg/AAO Website/Exquisite Corpse/corpse/node_modules/@babel/runtime/helpers/esm/inherits.js\";import _createSuper from\"/home/sagnikg/AAO Website/Exquisite Corpse/corpse/node_modules/@babel/runtime/helpers/esm/createSuper.js\";import React,{Component}from'react';import{socket}from'../socket';import p5 from'p5';import{isMobile}from'react-device-detect';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Sketch=/*#__PURE__*/function(_Component){_inherits(Sketch,_Component);var _super=_createSuper(Sketch);function Sketch(props){var _this;_classCallCheck(this,Sketch);_this=_super.call(this,props);_this.state={username:_this.props.username,// active: true,\nbrushSize:5,mode:1,scale:Math.min((window.innerWidth-20)/500,(window.innerHeight-20)/500,1)};_this.myRef=/*#__PURE__*/React.createRef();_this.paintMode=_this.paintMode.bind(_assertThisInitialized(_this));_this.eraseMode=_this.eraseMode.bind(_assertThisInitialized(_this));_this.reset=_this.reset.bind(_assertThisInitialized(_this));_this.sendSketch=_this.sendSketch.bind(_assertThisInitialized(_this));_this.submit=_this.submit.bind(_assertThisInitialized(_this));_this.clue=null;_this.sendTo=null;return _this;}_createClass(Sketch,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;if(this.sketch){this.sketch.remove();}this.sketch=new p5(function(p){p.setup=function(){// let height = window.innerHeight*(isMobile?1.2:1);\np.pixelDensity(1);_this2.canvas=p.createCanvas(500,500).parent(_this2.myRef.current);p.background('#ffffff');};p.draw=function(){if(p.mouseIsPressed&&_this2.state.active){p.stroke(_this2.state.mode?\"#000000\":\"#ffffff\");p.strokeWeight(_this2.state.brushSize*_this2.state.brushSize);var sc=_this2.state.scale;p.line(p.mouseX/sc,p.mouseY/sc,p.pmouseX/sc,p.pmouseY/sc);}};socket.on(\"receiveSketch\",function(data){p.loadImage(data.clue,function(img){_this2.clue=img;p.background(255);p.image(img,0,0);console.log(data.from);});});});socket.on(\"receiveActive\",function(name){if(name==_this2.state.username){_this2.setState({active:true});}else{_this2.setState({active:false});}});window.addEventListener('sendTo',function(e){// console.log(e.detail);\n_this2.sendTo=e.detail;_this2.sendSketch();});}},{key:\"sendSketch\",value:function sendSketch(){if(this.canvas){//full canvas\nvar fullCanvasData=this.canvas.elt.toDataURL();var hidden_canv=document.createElement('canvas');hidden_canv.style.display='none';document.body.appendChild(hidden_canv);hidden_canv.width=500;hidden_canv.height=75;var hidden_ctx=hidden_canv.getContext('2d');hidden_ctx.drawImage(this.canvas.elt,0,//Start Clipping\n425,//Start Clipping\n500,//Clipping Width\n75,//Clipping Height\n0,//Place X\n0,//Place Y\nhidden_canv.width,//Place Width\nhidden_canv.height//Place Height\n);var clueCanvasData=hidden_canv.toDataURL();// socket.emit(\"dummySendSketch\", clueCanvasData);\nsocket.emit(\"sendSketch\",{from:this.state.username,to:this.sendTo,clueCnvs:clueCanvasData,cnvs:fullCanvasData});}}},{key:\"paintMode\",value:function paintMode(){this.setState({mode:1});}},{key:\"eraseMode\",value:function eraseMode(){this.setState({mode:0});}},{key:\"reset\",value:function reset(){if(this.sketch){this.sketch.background(255);if(this.clue){this.sketch.image(this.clue,0,0);}}}},{key:\"submit\",value:function submit(){if(this.canvas){var fullCanvasData=this.canvas.elt.toDataURL();socket.emit(\"endGame\",{from:this.state.username,to:this.sendTo,cnvs:fullCanvasData});}// console.log(fullCanvasData);\n}},{key:\"render\",value:function render(){var _this3=this;var guard=/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",background:\"var(--blur1)\",height:\"100%\",width:\"100%\",backdropFilter:\"blur(10px)\",alignItems:\"center\",justifyContent:\"center\",display:\"flex\",opacity:1},children:\"WAIT FOR YOUR TURN...\"});return/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",flexDirection:isMobile?\"column\":\"row\",flex:1,alignItems:\"center\",justifyContent:\"center\",position:\"relative\",width:\"100vw\"},children:[/*#__PURE__*/_jsx(\"div\",{style:{flex:1,display:\"flex\",alignItems:\"center\",justifyContent:\"center\",transform:\"scale(\"+this.state.scale+\")\"},ref:this.myRef}),/*#__PURE__*/_jsxs(\"div\",{className:\"brushOptions\",style:{// background: \"rgba(0,0,0,0.5)\",\njustifySelf:\"flex-end\",float:\"right\",height:isMobile?\"auto\":\"100%\",//\"100vh\",\nflexDirection:isMobile?\"row\":\"column\",flexWrap:\"wrap\",display:\"flex\",justifyContent:isMobile?\"space-evenly\":\"center\",alignItems:\"center\",margin:\"0.1em\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"range\",min:\"1\",max:\"10\",step:\"0.5\",className:\"slider\",onChange:function onChange(e){return _this3.setState({brushSize:e.target.value});},value:this.state.brushSize}),/*#__PURE__*/_jsx(\"button\",{style:{width:isMobile?\"auto\":\"90%\",background:this.state.mode?\"var(--bg3)\":\"var(--bg2)\"},onClick:this.paintMode,children:\"Paint\"}),/*#__PURE__*/_jsx(\"button\",{style:{width:isMobile?\"auto\":\"90%\",background:this.state.mode?\"var(--bg2)\":\"var(--bg3)\"},onClick:this.eraseMode,children:\"Erase\"}),/*#__PURE__*/_jsx(\"button\",{style:{width:isMobile?\"auto\":\"90%\",background:\"var(--bg2)\"},onClick:this.reset,children:\"Reset\"}),/*#__PURE__*/_jsx(\"button\",{style:{width:isMobile?\"auto\":\"90%\",background:\"var(--bg2)\"},onClick:this.submit,children:\"End Game\"})]}),this.state.active?/*#__PURE__*/_jsx(_Fragment,{}):guard]});}}]);return Sketch;}(Component);export default Sketch;","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}